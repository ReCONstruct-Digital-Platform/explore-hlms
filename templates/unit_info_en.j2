
<div id="lot-info">
    <div id="lot-info-top-row">
        <strong>
            <div id="unit-address">
                {{ unit.address }}, 
                <small>
                {{unit.muni}}
                </small>
            </div>
        </strong>
        <div id="close-button">
            <svg width="24px" height="24px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237 18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071 17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834 19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976 5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z" fill="##ffffff"/>
            </svg>
        </div>
        <script>
            document.getElementById('close-button').addEventListener('click', (e) => {
                document.getElementById('info-overlay').setAttribute('data-visible', false);
            });
        </script>
    </div>

    <div>
        <small>ID {{ unit.id }}</small>
    </div>
    <div>
        {% if unit.num_adr_sup %}
        <small>(multiple addresses)</small>
        {% endif %}
    </div>

    <div id="lot-characteristics" class="mt-1">
        <div class="flex items-center font-sm">
            <span>
                Lot characteristics
            </span>
            <a class="ps-2" type="button" target="_blank" 
                href="https://www.donneesquebec.ca/recherche/dataset/061c8cb7-ca4e-45be-a990-61fce7e7d2dc/resource/6f2599be-e49d-4b9a-8702-b12ad0f56141/download/gui_donneesrolesformatouvert_vf20220627.pdf#page=13">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" class="bi bi-info-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                </svg>
            </a>
            
        </div>
        <hr class="m-0">
        <table id="lot-info-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Area</th>
                    <th>Linear dim.</th>
                    <th>Owner type</th>
                    <th>Owner status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{unit.lot_number}}</td>
                    <td>
                    {% if unit.lot_area %}
                        {{unit.lot_area}} m<sup>2</sup>
                    {% else %}
                        &mdash;
                    {% endif %}
                    </td>
                    <td>
                    {% if unit.lot_lin_dim %}
                        {{unit.lot_lin_dim}} m
                    {% else %}
                        &mdash;
                    {%endif%}
                    </td>

                    <td>{{unit.owner_type}}</td>
                    <td>{{unit.owner_status}}</td>
                </tr>
            </tbody>
        </table>
        <script>
            new DataTable('#lot-info-table', {
                info: false,
                ordering: false,
                paging: false,
                searching: false
            });
        </script>
    </div>

    <div id="building-characteristics" class="mt-2">
        <div id="unit-phys-chars" class="unit-info-subsection-header flex items-center">
            Main building characteristics
            <a class="ps-2" type="button" target="_blank" 
                href="https://www.donneesquebec.ca/recherche/dataset/061c8cb7-ca4e-45be-a990-61fce7e7d2dc/resource/6f2599be-e49d-4b9a-8702-b12ad0f56141/download/gui_donneesrolesformatouvert_vf20220627.pdf#page=16">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" class="bi bi-info-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                </svg>
            </a>
        </div>
        <hr class="m-0">

        <table id="lot-building-table">
            <thead>
                <tr>
                    <th>Dwellings</th>
                    <th>Max. floors</th>
                    <th>Const. year</th>
                    <th>Floor area</th>
                    <th>Physical link</th>
                    <th>Const. type</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                    {% if unit.num_dwelling %}
                        {{unit.num_dwelling}}
                    {% else %}
                        &mdash;
                    {% endif %}
                    </td>

                    <td>
                    {% if unit.max_floor %}
                        {{unit.max_floor}}
                    {% else %}
                        &mdash;
                    {% endif %}
                    </td>

                    <td>                
                    {% if unit.const_yr %}
                    {{ unit.const_yr }}
                        {% if unit.const_yr_real == 'E' %}
                            (est.)
                        {% endif %} 
                    {% else %}
                        &mdash;
                    {% endif %}
                    </td>

                    <td>
                    {% if unit.floor_area %}
                        {{unit.floor_area}} m<sup>2</sup>
                    {% else %}
                        &mdash;
                    {% endif %}
                    </td>

                    <td>{{unit.phys_link }}</td>
                    <td>{{unit.const_type}}</td>
                </tr>
            </tbody>
        </table>
        <script>
            new DataTable('#lot-building-table', {
                info: false,
                ordering: false,
                paging: false,
                searching: false
            });
        </script>
    </div>

    {% if unit.hlms %}
    <div id="hlms-block" class="mt-3">

        <div class="unit-info-subsection-header">
            HLMs ({{ unit.hlms|length }}) &dash; {{ unit.hlms[0].organism }}, {{ unit.hlms[0].service_center }}
        </div>
        <hr class="m-0">

        <table id="lot-hlms-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Address</th>
                    <th>Dwellings</th>
                    <th>Floors</th>
                    <th class="flex items-center">IVP
                        <a class="ps-2" type="button" target="_blank" 
                            href="http://www.habitation.gouv.qc.ca/fileadmin/internet/documents/partenaires/guides/guide-immeuble-supplement1-section02.pdf#page=4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" class="bi bi-info-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                            </svg>
                        </a>
                    </th>
                    <th>Category</th>
                </tr>
            </thead>
            <tbody>
            {% for hlm in unit.hlms %}
                <tr>
                    <td>{{hlm.id}}</td>
                    <td>{{hlm.address}}</td>
                    <td>{{hlm.num_dwelling}}</td>
                    <td>{{hlm.num_floors}}</td>
                    <td>
                    <span class="disrepair-badge disrepair-badge-{{hlm.disrepair_state}}">
                    {{hlm.ivp}}%
                    </span>
                    </td>
                    <td>{{hlm.category}}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <script>
            new DataTable('#lot-hlms-table', {
                info: false,
                ordering: true,
                paging: false,
                searching: false
            });
        </script>
    </div>
    {% endif %}
</div>
